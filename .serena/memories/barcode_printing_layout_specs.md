# バーコード印刷レイアウト仕様書

## 1. 商品バーコードラベル印刷仕様

### 用紙設定
- **用紙サイズ**: A4
- **印刷単位**: ミリメートル (GraphicsUnit.Millimeter)
- **補間モード**: NearestNeighbor（バーコードの鮮明性確保）

### レイアウト構成
#### グリッド配置
- **列数**: 4列
- **行数**: 11行
- **合計ラベル数**: 44枚/ページ

#### 寸法詳細（単位：mm）
```
ページマージン:
  上: 8.0mm
  左: 8.4mm

セルサイズ:
  幅: 48.3mm
  高: 25.4mm
```

#### セル内レイアウト
```
商品名:
  位置: (左余白 + 1.0mm, 上余白 + 0.2mm)
  フォント: MS UI Gothic 9pt

店舗名:
  位置: (左余白 + 1.0mm, 上余白 + 3.5mm)
  フォント: MS UI Gothic 8pt
  形式: "おみせ: [店舗名]"

バーコード画像:
  位置: (左余白 + 3.2mm, 上余白 + 7.0mm)
  サイズ: 元画像の横0.3倍、縦0.14倍
```

#### グリッド線（オプション）
- **線幅**: 0.1mm
- **色**: 黒
- **描画**: 縦横の区切り線を全体に描画

### 座標計算式
```
X座標 = marginPageLeft + (列番号 × marginPrintWeight)
Y座標 = marginPageTop + (行番号 × marginPrintHeight)
```

## 2. レシート印刷仕様

### 用紙設定
- **用紙幅**: 70mm（感熱紙想定）
- **印刷単位**: ミリメートル
- **左右マージン**: 3mm〜70mm

### レイアウト構成

#### ヘッダー部
```
ロゴ画像:
  ファイル: Kids.jpg
  位置: (3mm, 3mm)
  サイズ: 67mm × 20mm

タイトル:
  内容: "<レシート>"
  位置: 中央揃え（27mm）
  フォント: MS UI Gothic 13pt
  上マージン: ロゴ下 + 22mm + 7mm
```

#### 日時表示
```
位置: 左寄せ（3mm）
形式: "yyyy年MM月dd日 HH時mm分ss秒"
フォント: MS UI Gothic 10pt
```

#### 商品リスト
```
各商品行:
  商品名・数量: 左寄せ（3mm）
  金額: 左寄せ（18mm）、¥マーク付き
  フォント: MS UI Gothic 13pt
  行高: 7mm
```

#### 合計部
```
項目配置:
  ラベル: 左寄せ（3mm）
  金額: 左寄せ（18mm）
  
表示項目:
  - ごうけい
  - おあずかり
  - おつり
```

#### フッター部
```
店舗情報:
  形式: "おみせ：　[店舗名]"
  
担当者情報:
  形式: "れじのたんとう：　[担当者名]"

保管指示:
  内容: "印字保護のためこちらの面を\n内側に折って保管してください"
  位置: 左寄せ（6mm）
```

#### 会計バーコード
```
位置: 中央揃え（14mm）
サイズ: 横0.34倍、縦0.14倍
上マージン: 前行から10mm
```

### 行間設定
- **標準行高**: 7mm
- **セクション間**: 区切り線で分離

## 3. システムバーコード印刷仕様

### 基本設定
- レシートと同じ用紙設定を使用
- タイトル位置: 中央から左に20mmオフセット

### バーコードレイアウト
```
各バーコード:
  ラベル位置: 中央から左に12mmオフセット
  画像位置: 中央から左に13mmオフセット
  画像サイズ: 横0.34倍、縦0.14倍
  行間隔: ラベル後3mm減算、画像後17mm（7mm + 10mm）
```

## 4. 座標系とアライメント

### 基準点
- **marginMin**: 3mm（左端基準）
- **marginMax**: 70mm（右端基準）
- **alignCenter**: 27mm（中央基準）
- **lineHeight**: 7mm（標準行高）

### 描画位置管理
- DrawHeightPositionで垂直位置を累積管理
- 各要素描画後に適切な値を加算して次の位置を決定

## 5. バーコード生成仕様

### ZXing設定
- **形式**: CODE39または設定値（BarcodeConfig.Format）
- **エンコード**: "A" + [バーコード値] + "A"
- **画像形式**: Bitmap

### スケーリング
- 商品ラベル: 横0.3倍、縦0.14倍
- レシート/システム: 横0.34倍、縦0.14倍

## 注意事項
1. すべての寸法はミリメートル単位で指定
2. フォントサイズはポイント単位
3. バーコード画像は比率で縮小して鮮明性を保持
4. グリッド線印刷は必要時のみ（パフォーマンス考慮）